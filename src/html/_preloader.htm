<script>
	function preloader() {
		const preloaderImages = document.querySelector('[data-preloader]') ? document.querySelectorAll('[data-preloader] img') : document.querySelectorAll('img');
		// const preloaderContainer = document.querySelector('#fls-preloader');
		if (preloaderImages.length) {
			const preloaderTemplate = `
						<div class="graphic-main__counter">0%</div>
						`;
			document.querySelector('.graphic-main').insertAdjacentHTML("beforeend", preloaderTemplate);

			const
				// preloader = document.querySelector('.fls-preloader'),
				showPecentLoad = document.querySelector('.graphic-main__counter'),
				htmlDocument = document.documentElement;

			let imagesLoadedCount = counter = progress = 0;

			htmlDocument.classList.add('loading');
			htmlDocument.classList.add('lock');

			preloaderImages.forEach(preloaderImage => {
				const imgClone = document.createElement('img');
				if (imgClone) {
					imgClone.onload = imageLoaded;
					imgClone.onerror = imageLoaded;
					preloaderImage.dataset.src ? imgClone.src = preloaderImage.dataset.src : imgClone.src = preloaderImage.src;
				}
			});
			function setValueProgress(progress) {
				showPecentLoad ? showPecentLoad.innerText = `${progress}%` : null;

			}
			showPecentLoad ? setValueProgress(progress) : null;

			function imageLoaded() {
				imagesLoadedCount++;
				progress = Math.round((100 / preloaderImages.length) * imagesLoadedCount);
				const intervalId = setInterval(() => {
					counter >= progress ? clearInterval(intervalId) : setValueProgress(++counter);
					counter >= 100 ? addLoadedClass() : null;
				}, 10);
			}
			function addLoadedClass() {
				showPecentLoad.classList.add('_done');
				setTimeout(() => {
					htmlDocument.classList.add('loaded');
				}, 100);
				htmlDocument.classList.remove('lock');
				htmlDocument.classList.remove('loading');

			}
		}
	}
	preloader();
</script>